(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"4/Id":function(n,l,t){"use strict";t.r(l);var u=t("CcnG"),e=t("0/uQ"),i=t("gcOT"),o=t("psW0"),r=t("t/Na"),c=function(){function n(n){this.http=n,this.urlApiGeoloc="https://api-adresse.data.gouv.fr/reverse/"}return n.prototype.recupererInfosCommune=function(n,l){return this.http.get(this.urlApiGeoloc+"?long="+l+"&lat="+n)},n.prototype.recupererGeoLocEtCommune=function(){var n=this;return Object(e.a)(i.a.Geolocation.getCurrentPosition({timeout:3e4}).then((function(n){return[n.coords.latitude,n.coords.longitude]}))).pipe(Object(o.a)((function(l){return n.recupererInfosCommune(l[0],l[1])})))},n.ngInjectableDef=u.Tb({factory:function(){return new n(u.Ub(r.c))},token:n,providedIn:"root"}),n}(),a=t("909l"),b=t("AytR"),p=t("67Y/"),s=function(){function n(n){this.http=n,this.URL_BACKEND=b.a.backendUrl,this.httpOptions={headers:new r.g({"Content-Type":"application/json"}),withCredentials:!0}}return n.prototype.recupererNotifications=function(n){return this.http.post(this.URL_BACKEND+"/recupereralertes",n,this.httpOptions).pipe(Object(p.a)((function(n){return n.map((function(n){return n.dateDebut=new Date(n.dateDebut),n.dateFin=new Date(n.dateFin),n}))})))},n.ngInjectableDef=u.Tb({factory:function(){return new n(u.Ub(r.c))},token:n,providedIn:"root"}),n}(),f=function(n){return n.METEO="METEO",n.POLLUTION="POLLUTION",n}({}),d=function(){function n(n,l){this.geolocService=n,this.notifService=l,this.listeNotifications=[]}return n.prototype.ngOnInit=function(){var n=this;this.geolocService.recupererGeoLocEtCommune().subscribe((function(l){if(l.features.length>0){var t=l.features[0].properties.context.split(",").map((function(n){return n.trim()}));n.recupererNotifications(l.features[0].properties.citycode,t[1],t[2]).subscribe((function(l){var t=l[1],u=l[2],e=l[3],i=l[4],o=l[5];l[0].forEach((function(l){return n.listeNotifications.push({notification:l,expanded:!1})})),t.forEach((function(l){return n.listeNotifications.push({notification:l,expanded:!1})})),u.forEach((function(l){return n.listeNotifications.push({notification:l,expanded:!1})})),e.forEach((function(l){return n.listeNotifications.push({notification:l,expanded:!1})})),i.forEach((function(l){return n.listeNotifications.push({notification:l,expanded:!1})})),o.forEach((function(l){return n.listeNotifications.push({notification:l,expanded:!1})})),0===n.listeNotifications.length&&(n.messageError="Vous n\u2019avez pas de notification")}))}else n.messageError="Impossible de definir votre position"}),(function(l){return n.messageError="Impossible de definir votre position"}))},n.prototype.recupererNotifications=function(n,l,t){return Object(a.a)(this.notifService.recupererNotifications({codeCommune:n,type:f.METEO}),this.notifService.recupererNotifications({departement:l,type:f.METEO}),this.notifService.recupererNotifications({region:t,type:f.METEO}),this.notifService.recupererNotifications({codeCommune:n,type:f.POLLUTION}),this.notifService.recupererNotifications({departement:l,type:f.POLLUTION}),this.notifService.recupererNotifications({region:t,type:f.POLLUTION}))},n.prototype.expandItem=function(n){n.expanded?n.expanded=!1:this.listeNotifications.map((function(l){return l.expanded=n===l&&!l.expanded,l}))},n}(),h=function(){return function(){}}(),g=t("pMnS"),m=t("oBZk"),O=t("ZZ/e"),E=t("Ip0R"),k=t("QIWt"),N=t("8vzc"),y=t("MbMy"),x=t("6PnS"),I=u.sb({encapsulation:0,styles:[["ion-card[_ngcontent-%COMP%]{width:100%;margin:0;border-radius:0}ion-card-content[_ngcontent-%COMP%]{padding:0}ion-card-header[_ngcontent-%COMP%]{padding:8px}ion-label[_ngcontent-%COMP%]{padding:0 20px}ion-img[_ngcontent-%COMP%]{margin:auto}ion-item[_ngcontent-%COMP%]{--padding-bottom:0;--padding-end:0;--padding-start:0;--padding-top:0;--inner-padding-end:0}span[_ngcontent-%COMP%]{color:#6581b1;font-weight:700}ion-card-title[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}"]],data:{}});function v(n){return u.Qb(0,[(n()(),u.ub(0,0,null,null,3,"ion-text",[["class","ion-text-center"],["color","primary"]],null,null,null,m.kb,m.D)),u.tb(1,49152,null,0,O.yb,[u.h,u.k,u.A],{color:[0,"color"]},null),(n()(),u.ub(2,0,null,0,1,"h3",[],null,null,null,null,null)),(n()(),u.Ob(3,null,["",""]))],(function(n,l){n(l,1,0,"primary")}),(function(n,l){n(l,3,0,l.component.messageError)}))}function A(n){return u.Qb(0,[(n()(),u.ub(0,0,null,null,7,"ion-card-title",[],null,null,null,m.N,m.h)),u.tb(1,49152,null,0,O.r,[u.h,u.k,u.A],null,null),(n()(),u.ub(2,0,null,0,1,"ion-icon",[["name","partly-sunny"],["size","large"]],null,null,null,m.V,m.o)),u.tb(3,49152,null,0,O.D,[u.h,u.k,u.A],{name:[0,"name"],size:[1,"size"]},null),(n()(),u.ub(4,0,null,0,3,"ion-text",[["class","ion-padding-horizontal"]],null,null,null,m.kb,m.D)),u.tb(5,49152,null,0,O.yb,[u.h,u.k,u.A],null,null),(n()(),u.ub(6,0,null,0,1,"h4",[],null,null,null,null,null)),(n()(),u.Ob(-1,null,["Alerte m\xe9t\xe9o"]))],(function(n,l){n(l,3,0,"partly-sunny","large")}),null)}function M(n){return u.Qb(0,[(n()(),u.ub(0,0,null,null,7,"ion-card-title",[],null,null,null,m.N,m.h)),u.tb(1,49152,null,0,O.r,[u.h,u.k,u.A],null,null),(n()(),u.ub(2,0,null,0,1,"ion-icon",[["name","cloud-circle"],["size","large"]],null,null,null,m.V,m.o)),u.tb(3,49152,null,0,O.D,[u.h,u.k,u.A],{name:[0,"name"],size:[1,"size"]},null),(n()(),u.ub(4,0,null,0,3,"ion-text",[["class","ion-padding-horizontal"]],null,null,null,m.kb,m.D)),u.tb(5,49152,null,0,O.yb,[u.h,u.k,u.A],null,null),(n()(),u.ub(6,0,null,0,1,"h4",[],null,null,null,null,null)),(n()(),u.Ob(-1,null,["Alerte pollution"]))],(function(n,l){n(l,3,0,"cloud-circle","large")}),null)}function P(n){return u.Qb(0,[(n()(),u.ub(0,0,null,null,34,"ion-item",[],null,null,null,m.Y,m.r)),u.tb(1,49152,null,0,O.I,[u.h,u.k,u.A],null,null),(n()(),u.ub(2,0,null,0,32,"ion-card",[],null,[[null,"click"]],(function(n,l,t){var u=!0;return"click"===l&&(u=!1!==n.component.expandItem(n.context.$implicit)&&u),u}),m.O,m.e)),u.tb(3,49152,null,0,O.n,[u.h,u.k,u.A],null,null),(n()(),u.ub(4,0,null,0,5,"ion-card-header",[],null,null,null,m.M,m.g)),u.tb(5,49152,null,0,O.p,[u.h,u.k,u.A],null,null),(n()(),u.jb(16777216,null,0,1,null,A)),u.tb(7,16384,null,0,E.k,[u.P,u.M],{ngIf:[0,"ngIf"]},null),(n()(),u.jb(16777216,null,0,1,null,M)),u.tb(9,16384,null,0,E.k,[u.P,u.M],{ngIf:[0,"ngIf"]},null),(n()(),u.ub(10,0,null,0,24,"ion-card-content",[],null,null,null,m.L,m.f)),u.tb(11,49152,null,0,O.o,[u.h,u.k,u.A],null,null),(n()(),u.ub(12,0,null,0,22,"app-expandable",[],null,null,null,k.b,k.a)),u.tb(13,49152,null,0,N.a,[u.E],{expanded:[0,"expanded"]},null),(n()(),u.ub(14,0,null,0,6,"ion-item",[],null,null,null,m.Y,m.r)),u.tb(15,49152,null,0,O.I,[u.h,u.k,u.A],null,null),(n()(),u.ub(16,0,null,0,4,"ion-label",[],null,null,null,m.Z,m.s)),u.tb(17,49152,null,0,O.O,[u.h,u.k,u.A],null,null),(n()(),u.ub(18,0,null,0,1,"span",[],null,null,null,null,null)),(n()(),u.Ob(-1,null,["Message: "])),(n()(),u.Ob(20,0,[" "," "])),(n()(),u.ub(21,0,null,0,6,"ion-item",[],null,null,null,m.Y,m.r)),u.tb(22,49152,null,0,O.I,[u.h,u.k,u.A],null,null),(n()(),u.ub(23,0,null,0,4,"ion-label",[],null,null,null,m.Z,m.s)),u.tb(24,49152,null,0,O.O,[u.h,u.k,u.A],null,null),(n()(),u.ub(25,0,null,0,1,"span",[],null,null,null,null,null)),(n()(),u.Ob(-1,null,["Date de d\xe9but: "])),(n()(),u.Ob(27,0,[" "," "])),(n()(),u.ub(28,0,null,0,6,"ion-item",[],null,null,null,m.Y,m.r)),u.tb(29,49152,null,0,O.I,[u.h,u.k,u.A],null,null),(n()(),u.ub(30,0,null,0,4,"ion-label",[],null,null,null,m.Z,m.s)),u.tb(31,49152,null,0,O.O,[u.h,u.k,u.A],null,null),(n()(),u.ub(32,0,null,0,1,"span",[],null,null,null,null,null)),(n()(),u.Ob(-1,null,["Date de fin: "])),(n()(),u.Ob(34,0,[" "," "]))],(function(n,l){n(l,7,0,"METEO"===l.context.$implicit.notification.type),n(l,9,0,"POLLUTION"===l.context.$implicit.notification.type),n(l,13,0,l.context.$implicit.expanded)}),(function(n,l){n(l,20,0,l.context.$implicit.notification.message);var t=l.context.$implicit.notification.dateDebut.toLocaleString();n(l,27,0,t);var u=l.context.$implicit.notification.dateFin.toLocaleString();n(l,34,0,u)}))}function C(n){return u.Qb(0,[(n()(),u.ub(0,0,null,null,3,"ion-list",[],null,null,null,m.ab,m.t)),u.tb(1,49152,null,0,O.P,[u.h,u.k,u.A],null,null),(n()(),u.jb(16777216,null,0,1,null,P)),u.tb(3,278528,null,0,E.j,[u.P,u.M,u.t],{ngForOf:[0,"ngForOf"]},null)],(function(n,l){n(l,3,0,l.component.listeNotifications)}),null)}function L(n){return u.Qb(0,[(n()(),u.ub(0,0,null,null,1,"app-header",[["titreHeader","Notifications"]],null,null,null,y.b,y.a)),u.tb(1,114688,null,0,x.a,[],{titreHeader:[0,"titreHeader"]},null),(n()(),u.ub(2,0,null,null,5,"ion-content",[],null,null,null,m.Q,m.j)),u.tb(3,49152,null,0,O.v,[u.h,u.k,u.A],null,null),(n()(),u.jb(16777216,null,0,1,null,v)),u.tb(5,16384,null,0,E.k,[u.P,u.M],{ngIf:[0,"ngIf"]},null),(n()(),u.jb(16777216,null,0,1,null,C)),u.tb(7,16384,null,0,E.k,[u.P,u.M],{ngIf:[0,"ngIf"]},null)],(function(n,l){var t=l.component;n(l,1,0,"Notifications"),n(l,5,0,t.messageError),n(l,7,0,t.listeNotifications.length>0)}),null)}function j(n){return u.Qb(0,[(n()(),u.ub(0,0,null,null,1,"app-notifications",[],null,null,null,L,I)),u.tb(1,114688,null,0,d,[c,s],null,null)],(function(n,l){n(l,1,0)}),null)}var D=u.qb("app-notifications",d,j,{},{},[]),w=t("gIcY"),T=t("crBl"),S=t("ZYCi");t.d(l,"NotificationsPageModuleNgFactory",(function(){return U}));var U=u.rb(h,[],(function(n){return u.Db([u.Eb(512,u.j,u.cb,[[8,[g.a,D]],[3,u.j],u.y]),u.Eb(4608,E.m,E.l,[u.v,[2,E.F]]),u.Eb(4608,O.b,O.b,[u.A,u.g]),u.Eb(4608,O.Hb,O.Hb,[O.b,u.j,u.r]),u.Eb(4608,O.Kb,O.Kb,[O.b,u.j,u.r]),u.Eb(4608,w.p,w.p,[]),u.Eb(1073742336,E.b,E.b,[]),u.Eb(1073742336,O.Fb,O.Fb,[]),u.Eb(1073742336,T.a,T.a,[]),u.Eb(1073742336,w.o,w.o,[]),u.Eb(1073742336,w.d,w.d,[]),u.Eb(1073742336,S.p,S.p,[[2,S.u],[2,S.m]]),u.Eb(1073742336,h,h,[]),u.Eb(1024,S.k,(function(){return[[{path:"",component:d}]]}),[])])}))}}]);