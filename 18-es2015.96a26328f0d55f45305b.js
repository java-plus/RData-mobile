(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"4/Id":function(n,l,t){"use strict";t.r(l);var e=t("8Y7J"),i=t("Cfvw"),u=t("gcOT"),o=t("5+tZ"),r=t("IheW");let a=(()=>{class n{constructor(n){this.http=n,this.urlApiGeoloc="https://api-adresse.data.gouv.fr/reverse/"}recupererInfosCommune(n,l){return this.http.get(`${this.urlApiGeoloc}?long=${l}&lat=${n}`)}recupererGeoLocEtCommune(){return Object(i.a)(u.a.Geolocation.getCurrentPosition({timeout:3e4}).then(n=>[n.coords.latitude,n.coords.longitude])).pipe(Object(o.a)(([n,l])=>this.recupererInfosCommune(n,l)))}}return n.ngInjectableDef=e.Rb({factory:function(){return new n(e.Sb(r.c))},token:n,providedIn:"root"}),n})();var s=t("1uah"),c=t("AytR"),b=t("lJxs");let p=(()=>{class n{constructor(n){this.http=n,this.URL_BACKEND=c.a.backendUrl,this.httpOptions={headers:new r.g({"Content-Type":"application/json"}),withCredentials:!0}}recupererNotifications(n){return this.http.post(this.URL_BACKEND+"/recupereralertes",n,this.httpOptions).pipe(Object(b.a)(n=>n.map(n=>(n.dateDebut=new Date(n.dateDebut),n.dateFin=new Date(n.dateFin),n))))}}return n.ngInjectableDef=e.Rb({factory:function(){return new n(e.Sb(r.c))},token:n,providedIn:"root"}),n})();var d=function(n){return n.METEO="METEO",n.POLLUTION="POLLUTION",n}({});class f{constructor(n,l){this.geolocService=n,this.notifService=l,this.listeNotifications=[]}ngOnInit(){this.geolocService.recupererGeoLocEtCommune().subscribe(n=>{if(n.features.length>0){const l=n.features[0].properties.context.split(",").map(n=>n.trim());this.recupererNotifications(n.features[0].properties.citycode,l[1],l[2]).subscribe(([n,l,t,e,i,u])=>{n.forEach(n=>this.listeNotifications.push({notification:n,expanded:!1})),l.forEach(n=>this.listeNotifications.push({notification:n,expanded:!1})),t.forEach(n=>this.listeNotifications.push({notification:n,expanded:!1})),e.forEach(n=>this.listeNotifications.push({notification:n,expanded:!1})),i.forEach(n=>this.listeNotifications.push({notification:n,expanded:!1})),u.forEach(n=>this.listeNotifications.push({notification:n,expanded:!1})),0===this.listeNotifications.length&&(this.messageError="Vous n\u2019avez pas de notification")})}else this.messageError="Impossible de definir votre position"},n=>this.messageError="Impossible de definir votre position")}recupererNotifications(n,l,t){return Object(s.a)(this.notifService.recupererNotifications({codeCommune:n,type:d.METEO}),this.notifService.recupererNotifications({departement:l,type:d.METEO}),this.notifService.recupererNotifications({region:t,type:d.METEO}),this.notifService.recupererNotifications({codeCommune:n,type:d.POLLUTION}),this.notifService.recupererNotifications({departement:l,type:d.POLLUTION}),this.notifService.recupererNotifications({region:t,type:d.POLLUTION}))}expandItem(n){n.expanded?n.expanded=!1:this.listeNotifications.map(l=>(l.expanded=n===l&&!l.expanded,l))}}class h{}var g=t("pMnS"),m=t("oBZk"),y=t("ZZ/e"),O=t("SVse"),N=t("QIWt"),k=t("8vzc"),C=t("MbMy"),x=t("6PnS"),I=e.qb({encapsulation:0,styles:[["ion-card[_ngcontent-%COMP%]{width:100%;margin:0;border-radius:0}ion-card-content[_ngcontent-%COMP%]{padding:0}ion-card-header[_ngcontent-%COMP%]{padding:8px}ion-label[_ngcontent-%COMP%]{padding:0 20px}ion-img[_ngcontent-%COMP%]{margin:auto}ion-item[_ngcontent-%COMP%]{--padding-bottom:0;--padding-end:0;--padding-start:0;--padding-top:0;--inner-padding-end:0}span[_ngcontent-%COMP%]{color:#6581b1;font-weight:700}ion-card-title[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}"]],data:{}});function v(n){return e.Ob(0,[(n()(),e.sb(0,0,null,null,3,"ion-text",[["class","ion-text-center"],["color","primary"]],null,null,null,m.kb,m.D)),e.rb(1,49152,null,0,y.yb,[e.h,e.k,e.y],{color:[0,"color"]},null),(n()(),e.sb(2,0,null,0,1,"h3",[],null,null,null,null,null)),(n()(),e.Mb(3,null,["",""]))],(function(n,l){n(l,1,0,"primary")}),(function(n,l){n(l,3,0,l.component.messageError)}))}function M(n){return e.Ob(0,[(n()(),e.sb(0,0,null,null,7,"ion-card-title",[],null,null,null,m.N,m.h)),e.rb(1,49152,null,0,y.r,[e.h,e.k,e.y],null,null),(n()(),e.sb(2,0,null,0,1,"ion-icon",[["name","partly-sunny"],["size","large"]],null,null,null,m.V,m.o)),e.rb(3,49152,null,0,y.D,[e.h,e.k,e.y],{name:[0,"name"],size:[1,"size"]},null),(n()(),e.sb(4,0,null,0,3,"ion-text",[["class","ion-padding-horizontal"]],null,null,null,m.kb,m.D)),e.rb(5,49152,null,0,y.yb,[e.h,e.k,e.y],null,null),(n()(),e.sb(6,0,null,0,1,"h4",[],null,null,null,null,null)),(n()(),e.Mb(-1,null,["Alerte m\xe9t\xe9o"]))],(function(n,l){n(l,3,0,"partly-sunny","large")}),null)}function E(n){return e.Ob(0,[(n()(),e.sb(0,0,null,null,7,"ion-card-title",[],null,null,null,m.N,m.h)),e.rb(1,49152,null,0,y.r,[e.h,e.k,e.y],null,null),(n()(),e.sb(2,0,null,0,1,"ion-icon",[["name","cloud-circle"],["size","large"]],null,null,null,m.V,m.o)),e.rb(3,49152,null,0,y.D,[e.h,e.k,e.y],{name:[0,"name"],size:[1,"size"]},null),(n()(),e.sb(4,0,null,0,3,"ion-text",[["class","ion-padding-horizontal"]],null,null,null,m.kb,m.D)),e.rb(5,49152,null,0,y.yb,[e.h,e.k,e.y],null,null),(n()(),e.sb(6,0,null,0,1,"h4",[],null,null,null,null,null)),(n()(),e.Mb(-1,null,["Alerte pollution"]))],(function(n,l){n(l,3,0,"cloud-circle","large")}),null)}function L(n){return e.Ob(0,[(n()(),e.sb(0,0,null,null,34,"ion-item",[],null,null,null,m.Y,m.r)),e.rb(1,49152,null,0,y.I,[e.h,e.k,e.y],null,null),(n()(),e.sb(2,0,null,0,32,"ion-card",[],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.expandItem(n.context.$implicit)&&e),e}),m.O,m.e)),e.rb(3,49152,null,0,y.n,[e.h,e.k,e.y],null,null),(n()(),e.sb(4,0,null,0,5,"ion-card-header",[],null,null,null,m.M,m.g)),e.rb(5,49152,null,0,y.p,[e.h,e.k,e.y],null,null),(n()(),e.hb(16777216,null,0,1,null,M)),e.rb(7,16384,null,0,O.k,[e.N,e.K],{ngIf:[0,"ngIf"]},null),(n()(),e.hb(16777216,null,0,1,null,E)),e.rb(9,16384,null,0,O.k,[e.N,e.K],{ngIf:[0,"ngIf"]},null),(n()(),e.sb(10,0,null,0,24,"ion-card-content",[],null,null,null,m.L,m.f)),e.rb(11,49152,null,0,y.o,[e.h,e.k,e.y],null,null),(n()(),e.sb(12,0,null,0,22,"app-expandable",[],null,null,null,N.b,N.a)),e.rb(13,49152,null,0,k.a,[e.C],{expanded:[0,"expanded"]},null),(n()(),e.sb(14,0,null,0,6,"ion-item",[],null,null,null,m.Y,m.r)),e.rb(15,49152,null,0,y.I,[e.h,e.k,e.y],null,null),(n()(),e.sb(16,0,null,0,4,"ion-label",[],null,null,null,m.Z,m.s)),e.rb(17,49152,null,0,y.O,[e.h,e.k,e.y],null,null),(n()(),e.sb(18,0,null,0,1,"span",[],null,null,null,null,null)),(n()(),e.Mb(-1,null,["Message: "])),(n()(),e.Mb(20,0,[" "," "])),(n()(),e.sb(21,0,null,0,6,"ion-item",[],null,null,null,m.Y,m.r)),e.rb(22,49152,null,0,y.I,[e.h,e.k,e.y],null,null),(n()(),e.sb(23,0,null,0,4,"ion-label",[],null,null,null,m.Z,m.s)),e.rb(24,49152,null,0,y.O,[e.h,e.k,e.y],null,null),(n()(),e.sb(25,0,null,0,1,"span",[],null,null,null,null,null)),(n()(),e.Mb(-1,null,["Date de d\xe9but: "])),(n()(),e.Mb(27,0,[" "," "])),(n()(),e.sb(28,0,null,0,6,"ion-item",[],null,null,null,m.Y,m.r)),e.rb(29,49152,null,0,y.I,[e.h,e.k,e.y],null,null),(n()(),e.sb(30,0,null,0,4,"ion-label",[],null,null,null,m.Z,m.s)),e.rb(31,49152,null,0,y.O,[e.h,e.k,e.y],null,null),(n()(),e.sb(32,0,null,0,1,"span",[],null,null,null,null,null)),(n()(),e.Mb(-1,null,["Date de fin: "])),(n()(),e.Mb(34,0,[" "," "]))],(function(n,l){n(l,7,0,"METEO"===l.context.$implicit.notification.type),n(l,9,0,"POLLUTION"===l.context.$implicit.notification.type),n(l,13,0,l.context.$implicit.expanded)}),(function(n,l){n(l,20,0,l.context.$implicit.notification.message);var t=l.context.$implicit.notification.dateDebut.toLocaleString();n(l,27,0,t);var e=l.context.$implicit.notification.dateFin.toLocaleString();n(l,34,0,e)}))}function w(n){return e.Ob(0,[(n()(),e.sb(0,0,null,null,3,"ion-list",[],null,null,null,m.ab,m.t)),e.rb(1,49152,null,0,y.P,[e.h,e.k,e.y],null,null),(n()(),e.hb(16777216,null,0,1,null,L)),e.rb(3,278528,null,0,O.j,[e.N,e.K,e.r],{ngForOf:[0,"ngForOf"]},null)],(function(n,l){n(l,3,0,l.component.listeNotifications)}),null)}function P(n){return e.Ob(0,[(n()(),e.sb(0,0,null,null,1,"app-header",[["titreHeader","Notifications"]],null,null,null,C.b,C.a)),e.rb(1,114688,null,0,x.a,[],{titreHeader:[0,"titreHeader"]},null),(n()(),e.sb(2,0,null,null,5,"ion-content",[],null,null,null,m.Q,m.j)),e.rb(3,49152,null,0,y.v,[e.h,e.k,e.y],null,null),(n()(),e.hb(16777216,null,0,1,null,v)),e.rb(5,16384,null,0,O.k,[e.N,e.K],{ngIf:[0,"ngIf"]},null),(n()(),e.hb(16777216,null,0,1,null,w)),e.rb(7,16384,null,0,O.k,[e.N,e.K],{ngIf:[0,"ngIf"]},null)],(function(n,l){var t=l.component;n(l,1,0,"Notifications"),n(l,5,0,t.messageError),n(l,7,0,t.listeNotifications.length>0)}),null)}function D(n){return e.Ob(0,[(n()(),e.sb(0,0,null,null,1,"app-notifications",[],null,null,null,P,I)),e.rb(1,114688,null,0,f,[a,p],null,null)],(function(n,l){n(l,1,0)}),null)}var S=e.ob("app-notifications",f,D,{},{},[]),T=t("s7LF"),j=t("crBl"),z=t("iInd");t.d(l,"NotificationsPageModuleNgFactory",(function(){return F}));var F=e.pb(h,[],(function(n){return e.Bb([e.Cb(512,e.j,e.ab,[[8,[g.a,S]],[3,e.j],e.w]),e.Cb(4608,O.m,O.l,[e.t,[2,O.F]]),e.Cb(4608,y.b,y.b,[e.y,e.g]),e.Cb(4608,y.Hb,y.Hb,[y.b,e.j,e.q]),e.Cb(4608,y.Kb,y.Kb,[y.b,e.j,e.q]),e.Cb(4608,T.p,T.p,[]),e.Cb(1073742336,O.b,O.b,[]),e.Cb(1073742336,y.Fb,y.Fb,[]),e.Cb(1073742336,j.a,j.a,[]),e.Cb(1073742336,T.o,T.o,[]),e.Cb(1073742336,T.d,T.d,[]),e.Cb(1073742336,z.p,z.p,[[2,z.u],[2,z.m]]),e.Cb(1073742336,h,h,[]),e.Cb(1024,z.k,(function(){return[[{path:"",component:f}]]}),[])])}))}}]);